+++
title = "クライアント印刷技術の概要"
description = ""
weight = 11
+++
GO-Globalのクライアント印刷機能により、ホスト上のGO-Globalセッションで実行されているアプリケーションは、クライアントコンピュータまたはデバイスからアクセス可能なプリンタに印刷できます。この資料はこの機能の技術的な概要を提供したものです。

### **プロキシプリンタの作成と削除の方法**

ユーザがGO-Globalホストにサインインしてクライアント印刷機能が有効になると、Application Publishing Serviceはホストコンピュータ上にユーザのクライアントコンピューターまたはデバイスからアクセス可能なプリンタのプロキシとして機能するプリンターを作成します。 **プロキシプリンタ** と呼ばれるこれらのホスト側プリンタは、ホストコンピュータの[デバイスとプリンタ]アプレットの下に表示されます。管理者にはプロキシプリンタへのフルコントロール権限が与えられます。通常のユーザには、自分のプロキシプリンタへの印刷権限と自分のプロキシプリンタの管理権限が付与されています。

デフォルトでは、GO-Globalはクライアントコンピュータ上のユーザのデフォルトプリンタ用のプロキシプリンタのみを作成します。あるいは、 **–ac all** はGO-Globalクライアントのコマンドラインで指定されるか、 **printConfig=all** はブラウザからクライアントを実行するために使用されるURLで指定され、プロキシプリンタはクライアントコンピュータ上のユーザが利用できるすべてのプリンタに対して作成されます。同様に、 クライアントのコマンドラインで **–ac none** が指定されているか、 **printConfig=none** がクライアントのURLに追加されている場合、ユーザのセッションにプロキシプリンタは作成されません。このオプションは、ユーザのセッションのクライアント印刷機能を事実上無効にします。

プロキシプリンタ名のデフォルトの形式は、([ClientComputerName])の[ClientPrinterName]です。この形式は、 本ドキュメントサイトの[クライアントプリンタ名のカスタマイズ](/docs/go-globalrc61/advancedtopics/printersapplet/#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E5%90%8D%E3%81%AE%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA)の説明に従って変更できます。

プロキシプリンタは、それを作成したセッションが閉じると削除されます。

### **プリンタドライバの選択方法**

プロキシプリンタは、作成時に、プリンタ製造元のプリンタドライバまたはGO-GlobalのUniversalプリンタドライバのいずれかを使用するように設定されています。具体的には、 **[Host Options]** ダイアログボックスの **[Client Access]** タブで **[Windows Printer Drivers]** オプションが選択されていて、次の条件の少なくとも1つが満たされている場合、Application Publishing Serviceは製造元のプリンタドライバを使用するようにプロキシプリンタを設定します。

a. 関連付けられたクライアントプリンタは、Windowsにインストールされている製造元のプリンタドライバを使用するようにWindowsプリンタアプレットプログラムを介して以前に設定されています。
b. GO-Globalの **MappedPrinterDrivers.xml** ファイルには、クライアントプリンタのプリンタドライバの名前を、ホストコンピュータにインストールされている製造元のプリンタドライバにマップするエントリが含まれています。
c. クライアントプリンタのプリンタドライバの名前は、ホストコンピュータにインストールされている製造元のプリンタドライバの名前と同じです。

または、 **[Host Options]** ダイアログボックスの **[Client Access]** タブで **[Universal Printer Driver]** オプションが選択されていて、次の条件の少なくとも1つが満たされている場合、Application Publishing ServiceはプロキシプリンタがGO-GlobalのUniversalプリンタドライバを使用するように設定します。

1. 関連付けられたクライアントプリンタは、Universalプリンタドライバを使用するようにプログラムWindowsプリンタアプレットを介して以前に設定されています。
2. GO-Globalの **Map Printer Drivers.xml** ファイルには、クライアントプリンタのプリンタドライバの名前をUniversal Printer Driverにマップするエントリが含まれています。
3. **[Windows Printer Drivers]** オプションが選択されていないか、製造元のプリンタドライバの選択条件が満たされていません。

それ以外の場合、製造元のプリンタドライバの選択条件もUniversalプリンタドライバの選択条件も満たされないと、クライアントプリンタにプロキシプリンタは作成されず、ユーザはクライアントプリンタに印刷できなくなります。

製造元のプリンタドライバのインストールと管理、およびクライアントプリンタドライバの名前のサーバープリンタドライバへのマッピングは複雑なため、製造元のプリンタドライバでしか利用できない高度な機能が必要な場合を除き、管理者はUniversalプリンタドライバのみを有効にすることをお勧めします。特定のプリンタの高度な機能にアクセスする必要がある場合は、管理者が **Windows Printer Drivers** を有効にすることをお勧めしますが、ユーザが必要とする高度な機能を提供するプリンタの製造元のプリンタドライバのみをホストにインストールします。

### **プリンタ設定の方法**

Application Publishing Serviceは、プロキシプリンタを作成するときに、ユーザの`%APPDATA%\Roaming\GraphOn\GO-Global`ディレクトリをチェックインして、クライアントプリンタのカスタマイズ設定が前回のセッションから保存されているかどうかを確認します。クライアントプリンタの設定ファイルが見つかった場合、Application Publishing Serviceはそのファイルに保存されている設定でプロキシプリンタを作成します。または、設定ファイルが見つからない場合、Application Publishing Serviceは選択したドライバで指定されている既定の設定でプロキシプリンタを作成します。管理者は、 本ドキュメントサイドの[プリンタマッピングのデフォルトプリンタ設定ファイルの作成](/docs/go-globalrc61/advancedtopics/printersapplet/#%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%9E%E3%83%83%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90)セクションの手順に従って、プリンタドライバのデフォルト設定を含むファイルを作成できます。

{{% alert title="参照" color="info" %}}
プロキシプリンタがUniversalプリンタドライバを使用するように設定されている場合、そのプリンタのデフォルト設定は`C:\Windows\System32\spool\drivers\x64\3\UniversalRemotePrinter.ppd`ファイルによって制御されます。とりわけ、このファイルはUniversalプリンタドライバの余白を制御します。アプリケーションによっては、印刷出力をページの中央に配置するためにこのファイルを変更する必要があります。これについては、管理者ガイドの[印刷可能領域を調整する](/docs/go-globalrc61/advancedtopics/printersapplet/#%E5%8D%B0%E5%88%B7%E5%8F%AF%E8%83%BD%E9%A0%98%E5%9F%9F%E3%82%92%E8%AA%BF%E6%95%B4%E3%81%99%E3%82%8B)セクションで説明されています。
{{% /alert %}}

ユーザは[ファイル]メニューの[印刷]をクリックして、プリンタの設定をカスタマイズできます。GO-Global Printers Appletを実行するためのプログラムウィンドウ内のプリンタ。プリンタアプレットからプリンタの設定を変更しても、アプリケーションとセッションの間は維持されます。または、アプリケーションの[印刷]ダイアログボックスでプリンタの設定に加えた変更は、通常アプリケーションインスタンスにのみ適用され、アプリケーションを閉じると失われます。

{{% alert title="参照" color="info" %}}
ユーザがURLまたは特定のアプリケーションへのショートカットキーを使用してプログラムウィンドウを迂回する場合、管理者はそれを独立したアプリケーションとして公開することによってプリンタアプレットへのアクセスを提供できます。
{{% /alert %}}

### **プリンタの列挙の方法**

ユーザがアプリケーションの[印刷]ダイアログを開くと、アプリケーションはオペレーティングシステムに対して1つ以上の呼び出しを行って、利用可能なプリンタを列挙します。GO-Globalは、プリンタを列挙するアプリケーション要求を傍受し、(a)ユーザが利用できるホスト側プリンタ、および(b)アプリケーションが実行されているセッション用に作成されたプロキシプリンタを返します。

他のセッションに属する代理プリンタはフィルタリングされ、ユーザ(例えば管理者)が他の代理プリンタに対する権利を持っていても、ユーザは自分のセッションに属する代理プリンタだけを見ることができる。

### **Universalプリンタドライバで印刷する**

Universalプリンタドライバを使用して文書を印刷するプロセスを次の図に示します。

プロセスの手順は次のとおりです。

![9-201-1](/images/9-201-1.png)

1. アプリケーションは印刷ジョブを開始し、Windows APIを呼び出してドキュメントをプリンタにレンダリングします。
2. Microsoft PostScriptプリンタドライバは、アプリケーションのグラフィックコマンドをPostScript(PS)に変換し、PostScriptデータをプリントスプーラのプロキシプリンタのポートに送信します。
3. GO-Globalポートモニタは、Microsoft PostScriptプリンタドライバがプロキシプリンタのポートに送信したデータを受信します。
4. クライアントがWindowsまたはMacの場合、またはドキュメントがGO-GlobalのPreview PDFプリンタに印刷されている場合<br>
    a. GO-GlobalポートモニタはPostScriptデータをホスト上の一時ファイルに書き込みます。<br>
    b. ポートモニタは、すべての印刷ジョブデータを受信すると、VeryPDF PostScript to PDFコンバータを使用してPostScriptファイルをPDFファイルに変換します。<br> 
    c. 印刷ジョブがPDFファイルに変換されると、ポートモニタはApplication Publishing Serviceを介してそのPDFファイルをGO-Globalクライアントに送信します。<br> 
    d. GO-Globalポートモニタは、ホストから一時的なPostScriptファイルとPDFファイルを削除します。<br> 
    e. GO-GlobalクライアントはPDFファイルを受信し、それをクライアントコンピュータの一時ファイルに保存します。<br> 
    f. ドキュメントがGO-GlobalのPreview PDFプリンタで印刷された場合、クライアントはクライアントコンピュータのデフォルトのPDFビューアでPDFファイルを開きます。<br> 
    g. あるいは、文書がクライアントプリンタに印刷された場合、GO-GlobalクライアントはPDFファイルをプリンタに送信します。Mac OS Xでは、クライアントはオペレーティングシステムの組み込みサポートを使用してPDFファイルをプリンタに送信します。Windowsでは、クライアントは、GO-Globalクライアントに含まれているVeryPDFのpdfprint.exeユーティリティを使用してPDFファイルを印刷します。<br>

{{% alert title="参照" color="info" %}}
クライアントがWindows上で実行されていて、ホストのHostProperties.xmlファイルの **EnablePrintOptions** プロパティの値がtrueである場合、クライアントは **HostProperties.xml** ファイルの **PrintOptions** プロパティで指定されているコマンド行オプションを **pdfprint.exe** に追加します。
{{% /alert %}}
<br>
    h. クライアントは一時PDFファイルを削除します。<br> 

5. それ以外の場合、クライアントがLinux上で実行されていて、文書がクライアントプリンタに印刷されている場合<br> 
    a. GO-Globalポートモニタは、Application Publishing Serviceを介してPostScriptデータをクライアントに転送します。<br> 
    b. GO-GlobalクライアントはPostScriptデータをプリンタに送信します。<br> 

### **プリンタの製造元からプリンタドライバで印刷する方法**

プロキシプリンタがプリンタ製造元のプリンタドライバを使用するように設定されている場合、このプロセスは、Universalプリンタドライバを使用してLinuxクライアント上のプリンタにドキュメントを印刷するプロセスと似ています。この場合：

1. 製造元のプリンタドライバがアプリケーションのグラフィックスコマンドをプリンタが処理できる形式に変換します。これは標準フォーマット(例えばPostScript)または独自フォーマットにすることが出来ます。
2. 製造元のプリンタドライバが、印刷ジョブのデータをプリントスプーラのプリンタのポートに転送します。
3. GO-Globalポートモニタは印刷ジョブのデータを受信し、データを受信するとそれをGO-Globalクライアントに転送します。
4. GO-Globalクライアントが印刷ジョブのデータをプリンタに転送します。

### **ホスト側プリンタへの印刷**

ユーザがGO-Globalホストからアクセス可能なローカルプリンタまたはネットワークプリンタに印刷する場合、GO-Globalは関与しません。管理者は、ホスト側のプリンタに関する問題を解決するために、Microsoftのマニュアルおよびプリンタの製造元のマニュアルを参照する必要があります。