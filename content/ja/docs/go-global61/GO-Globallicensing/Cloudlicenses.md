---
title: "cloudライセンスについて"
linkTitle: ""
weight: 05
type: "docs"
---

cloudライセンスは、GO-GlobalのOn-premisesライセンスに代わるシンプルで可用性の高い代替手段を提供します。cloudライセンスは、ライセンスファイルがないため、管理が容易です。cloudライセンスでは、プロダクトコードやホストIDが不要で、GO-Globalを別のコンピュータにインストールする際にライセンスをリホストする必要がなく、GO-Globalのアップグレード時に新しいライセンスファイルを取得する必要がありません。<br>

GraphOnは、年間契約と月額契約の2種類のcloudライセンス契約をサポートしています。年間サブスクリプションでは、年間契約期間中に必要な同時接続シート数の上限を契約します。年間契約期間中に必要に応じてシート数を増やすことができますが、シート数を減らすことができるのは、次の年間契約期間の年間更新時のみです。別の方法として、月額サブスクリプションでは、お客様は各月次ターム中に使用された実際の最大同時使用シート数(すなわち、月次タームのハイポイント)に対してのみ請求されます。毎月のサブスクリプションでは、お客様はライセンスのシート制限を指定します。

# ライセンス作成 
cloudライセンスは通常、アクティベーションウィザードで新しいトライアルを開始することで作成され、顧客が注文を行うと本番用のcloudライセンスに変換されます。cloudトライアルライセンスを本番用cloudライセンスに変換するプロセスでは、お客様はライセンスを使用しているホストに変更を加える必要はありません。これにより、お客様はトライアル期間中にライセンスの設定を行い、注文完了後も設定を変更することなく継続して使用することができます。<br>

お客様がトライアルを開始した後、新たにcloudライセンスを発注する際には、お客様はGraphOnにcloudトライアルライセンスのライセンスマスターID(「LIC-xxxxx」の識別子)を提供し、ライセンスのサイト管理者を特定します。GraphOnは、トライアルを開始したユーザがライセンスのサイト管理者であることを確認し、注文処理を行います。注文が完了すると、ライセンスをcloudトライアルライセンスから本番ライセンスに変換します。ライセンスの有効期限とシート制限が更新され、ライセンスを使用しているホストは、ホストに変更を加えることなく、すぐに変更内容を確認します。その後、GraphOnは注文の連絡先に注文が完了したことを通知します。<br>

また、トライアルを開始していない状態でcloudトライアルライセンスを注文した場合、GraphOnはライセンスデータベースに新しいライセンスを作成し、新しいライセンスのライセンスマスターIDとプロダクトコードを注文の連絡先に電子メールで送信します。

{{% alert title="参照" color="info" %}}
cloudライセンスのプロダクトコードが必要なのは、お客様が緊急On-premisesライセンスを要求して問題に対処する必要がある場合だけです。
{{% /alert %}}

# GO-Globalのアクティベーション
cloudライセンスでGO-Globalを有効化するには、ライセンスにリストされているサイト管理者の1人がホストでアクティベーションウィザードを実行し、GraphOnアカウントでサインインして、ホストで使用するライセンスを選択する必要があります。

### On-premisesライセンスからcloudライセンスに切り替える方法
1. ホスト上の`\Program Files\GraphOn\GO-Global\Licensing`ディレクトリから、すべてのOn-premisesのライセンスファイルを削除する。
2. **GO-Global License Manager Service** を停止します。
3. **Application Publishing Service** を再起動します。
4. **アクティベーションウィザード** を実行します。

### cloudライセンスからOn-premisesライセンスに切り替える方法
1. 1つ以上のOn-premisesライセンスファイルをホストの`\Program Files\GraphOn\GO-Global\Licensing`ディレクトリにコピーします。ディレクトリをホスト上にコピーします。
2. **GO-Global License Manager Service** を停止します。
3. **Application Publishing Service** を再起動します。

その後、ホストの元のcloudライセンスを使用するように切り替える場合はLicensingディレクトリからOn-premisesのライセンスファイルを削除し、Application Publishing Serviceを再起動します。

# シートの追加と取り外し
cloudライセンスは、On-premisesライセンスとは異なり、シート数の上限を増減することができます。<br>

そのため、ホストが複数のcloudライセンスを持つ必要はなく、アドオン型のcloudライセンスなどもありません。ホストが使用しているcloudライセンスを変更することは可能ですが、ホストは一度に1つのcloudライセンスしか使用できません。<br>

前述のように、お客様はcloudライセンスのシート制限を増減することができますが、いつ、どのように変更できるかは、以下に説明するように、ライセンスのサブスクリプションの種類、すなわち、年間または月額サブスクリプションによって異なります。

* 年間サブスクリプション
お客様は、年間契約のシート数をいつでも増やすことができますが、年間契約のシート数を減らすことができるのは、1年ごとの更新時に、次のタームの年間契約のシート数を減らすことに限られます。<br>

年間契約期間中、お客様は必要に応じて座席数の追加注文をすることで座席数を増やすことができます。GraphOnが注文を処理すると、GraphOnはライセンスデータベース内のライセンスのシート数を増加させます。

年間契約が更新されると、お客様は次の年間契約期間の年間契約のシートリミットを増減することができます。年間更新時にシートリミットを増減させるには、更新時に新しいシートリミットを指定します。<br>

GraphOnが注文を処理した後、GraphOnのライセンスデータベースにライセンスのシートリミットを新しいリミットに設定します。

* 月間のサブスクリプション 
毎月のサブスクリプションでは、顧客は各サブスクリプション期間中に発生した最大同時使用量に対して課金されます。この場合、シート制限は同時に使用できるシート数に上限を設定し、シート制限で指定されたシート数を超えて請求されることがないようにします。顧客は、いつでも無料で、毎月のサブスクリプションのシート制限を増減することができます。サイト管理者は、カスタマーポータルのcloudライセンス管理アプリを介してライセンスのシート制限を編集できます。<br>

サブスクリプションの種類にかかわらず、cloudライセンスのシート制限の増減は、GraphOnのライセンスデータベースでシート制限が変更されるとすぐに、ライセンスを使用しているすべてのホストに適用されます。ライセンスを使用しているGO-Globalホストでは変更は必要ありません。

# ライセンスのアップグレードとリホスト 
On-premisesライセンスとは異なり、cloudサブスクリプションライセンスはGO-Globalのすべてのバージョンをサポートし、特定のコンピュータやコンピュータのMACアドレスに縛られません。そのため、アップグレードやリホストの必要はありません。また、GO-GlobalホストのMACアドレスが変更されても、問題なく機能し続けます。

# ライセンス管理
お客様は、カスタマーポータルの **Cloud License Management** アプリを使用して、cloudライセンスを管理することができます。このアプリには、ユーザがサイト管理者であるすべてのライセンスが表示されます。Cloud License Managementアプリを使用すると、ユーザは以下のことができます。

- ライセンスを使用しているホストなど、各ライセンスの詳細情報を表示します。
- ライセンスの説明を編集します。
- 月間サブスクリプションライセンスのシート数の制限を調整します。
- ライセンスのホストのいずれかでGO-Globalを非アクティブにします。

### Cloud License Managementアプリにアクセスする方法
1. カスタマーポータルにサインインします。
2. **License Management** をクリックします。
3. **Cloud Licenses** をクリックします。

# 複数のホスト環境
GO-Globalは同じcloudライセンスを使用して複数のホストでアクティベーションすることができますが、複数のホストがある環境では、アプリケーションホストマネージャ(Relay Load BalancerやFarm Managerなど)を使用するようにホストを設定し、アクティベーションウィザードをアプリケーションホストではなく、アプリケーションホストマネージャで実行することをお勧めします。これにより、アプリケーションホストマネージャが **Cloud License Service** と通信できない場合でも、すべてのホストでcloudライセンスのすべてのシートを使用できるようになります。

# 高可用性
GraphOnのcloudライセンスシステムは、高可用性を実現するために一から設計されています。<br>

cloudライセンスの信頼性は **GraphOn Cloud License Service** から始まります。GraphOn Cloud License Serviceは、高可用性環境でインターネット上にホストされたWebサービスです。複数の冗長性を持ち、単一障害点はありません。<br>

もちろん、cloudライセンスサービスに複数の冗長性を持たせても、ネットワーク障害でホストがサービスと通信できなくなった場合には、ほとんどメリットはありません。このため、ホストはcloudライセンスサービスと通信できなくなっても、最大72時間はクラウドライセンスの使用を継続することができます。<br>

このレベルの信頼性を提供するために、ホストは、ユーザがそれぞれセッションを開始したり停止したりするときに、cloudライセンスサービスからライセンスシートをチェックアウトしたりチェックインしたりしません。これは信頼性が低く、cloudライセンスサービスに大きな負荷をかけることになります。その代わりに、ホストはcloudライセンスサービスからシートを予約し、予約したシート数だけシートの使用を制限します。

## cloudライセンスサービスにホストが接続されている場合
Application Publishing Serviceが起動すると、cloudライセンスサービスに接続し、サービスとの間でシート予約のネゴシエーションを行います。cloudライセンスを使用するように構成されたホストが1台のみの場合、cloudライセンスサービスは、ホストのシート予約をcloudライセンスのシート制限に設定します。または、複数のホストがライセンスを使用するように構成されている場合、cloudライセンスサービスはライセンスのシートをホスト間で分配し、ホスト間で負荷が移動するとホストのシート予約を増減します。<br>

ユーザがホストにサインインすると、ホストはホストで使用中のシート数と予約したシート数を比較します。使用中のシート数が予約したシート数よりも少ない場合、ホストは使用中のシート数をインクリメントし、ユーザのセッションの開始を許可します。この場合、cloudライセンスサービスとの通信は不要です。または、ホストで既に使用中のシート数がホストが予約したシート数と同じ場合、ホストはcloudライセンスサービスにリクエストを送信して、ホストのシート予約を増やすように要求します。<br>

cloudライセンスサービスがシート予約の増加要求を受信すると、ライセンスを使用しているホストが予約したすべてのシートの合計がcloudライセンスのシート制限を下回っているかどうかを確認します。その場合、cloudライセンスサービスはホストのシート予約を増やし、その旨をホストに通知します。または、cloudライセンスのすべてのシートがすでに予約されており、cloudライセンスサービスに接続されているcloudライセンスを使用している他のホストが存在する場合、cloudライセンスサービスはライセンスを使用している他のホストとシート予約の再ネゴシーエョンを試み、シートを必要としているホストのためにシートを解放します。<br>

シート予約の再交渉中に、ライセンスを使用している他のホストのシートに空きがある場合、ホストは、使用していないすべてのシートを上限として、いくつかのシートをcloudライセンスサービスに解放します。cloudライセンスサービスは、要求するホストのシート予約を増加させ、その増加をホストに通知します。または、cloudライセンスを使用しているホストのいずれかで使用可能なシートがない場合(cloudライセンスのすべてのシートが使用中の場合）、cloudライセンスサービスは、使用可能なシートがないことをホストに通知します。この場合、ホストは、ライセンスで許可されているシートの最大数に達したことをユーザに通知し、ユーザのセッションの開始を阻止します。<br>

ホストがcloudライセンスサービスに接続されると、ホストは定期的にライセンス監査データをcloudライセンスサービスに送信します。この監査データには、以下のすべてのライセンス関連イベントの記録が含まれます。<br>

ホスト上で発生する(すべてのシートのチェックアウトとチェックイン、すべてのシート予約の変更など)。cloudライセンスサービスは、このデータをデータベースに保存し、このデータを使用して、毎月のサブスクリプションの各請求期間中の同時使用座席数の最大値を決定します。

## ホストがcloudライセンスサービスから切断された場合
ホストがcloudライセンスサービスから切断されると、cloudライセンスサービスへの接続が切断されたときに予約していたシート数に制限されます。ホストで使用中のシート数が予約したシート数を下回っている限り、ホストはcloudライセンスサービスに接続しているときと同じように機能します。ユーザがホストにサインインすると、ホストは使用中のシート数をインクリメントし、ユーザのセッションの開始を許可します。<br>

しかし、ホストがcloudライセンスサービスから切断され、ホストが予約したシートがすべて使用中の状態でユーザがホストにサインインした場合、ホストは予約したシートの増加を要求することができません。そのため、ライセンスで許可されている最大シート数に達したことをユーザに通知し、ユーザのセッションを開始できないようにします。<br>

ホストがcloudライセンスサービスから切断されると、管理者がAdmin Consoleを起動したり、ホストにサインインしたりするたびに警告が表示されます。この警告は、ホストがcloudライセンスサービスと通信できないこと、および **x** 時間以内に接続が回復しない場合は機能が停止することを示しています( **x** は72時間からホストがcloudライセンスサービスから切断された時間を差し引いたもの)。

ホストがcloudライセンスサービスから切断された状態が72時間以上続くと、ホストに接続しているすべてのユーザが切断されます。その後、ユーザのセッションに何が起こるかは、ホストで **Disconnected sessions terminate** が何に設定されているかによって異なります。 **Immediately** に設定されている場合、ホストはユーザセッションを直ちに終了します。 **Never** に設定されている場合、ユーザセッションは実行されたままですが、ホストがcloudライセンスサービスに再接続するまでユーザーは再接続できません。 **After x minutes** に設定されている場合、ユーザのセッションは最大x分までホスト上で実行されたままですが、指定された分数以内にホストがcloudライセンスサービスへの再接続に失敗した場合、ホストはユーザのセッションを終了します。

# シート予約　バックアップ保管場所
ホストは、シート予約を以下の場所に保存します。

- Application Publishing Serviceのメモリ内
- システム拡張ドライバで
- バックアップライセンスマネージャ(設定されている場合)

Application Publishing Serviceが起動し、cloudライセンスサービスに接続できない場合、Application Publishing Serviceは、まず、システム拡張ドライバから、次に、バックアップライセンスマネージャがある場合は、そのバックアップライセンスマネージャから、ホストのシート予約を判断しようとします。ホストがこれらの情報源からシート予約を判断できない場合(例えば、ホストコンピュータが再起動され、利用可能なバックアップライセンスマネージャがない場合)、ホストはシート予約をゼロに設定します。この場合、ホストがcloudライセンスサービスに接続するまで、ユーザはホスト上でセッションを開始することができません。

同様に、ホストはライセンス監査データを以下の場所に保存します。

- Application Publishing Serviceのメモリ内。
- システム拡張ドライバ内
- バックアップライセンスマネージャ(設定されている場合)
- ホストのハードドライブ上

ホストがcloudライセンスサービスから切断されると、これらの場所にライセンス監査データを記録し続けます。その後、ホストがcloudライセンスサービスに再接続すると、上記の各ソースのライセンス監査データをチェックして(リストされている順に)、それを持っている最初のソースからcloudライセンスサービスに累積された監査データを送信します。

# バックアップライセンスマネージャ
高可用性を実現するためには、バックアップライセンスマネージャが必要です。そのため、バックアップライセンスマネージャは、3台による冗長ライセンスサーバがOn-premisesライセンスであるのと同じように、cloudライセンスに対応しています。しかし、3台による冗長ライセンスサーバとは異なり、バックアップライセンスマネージャとサービスを提供するホストは、同じローカルネットワーク上にある必要はありません。

バックアップ ライセンス マネージャは以下の機能を提供します。

- cloudライセンスサービスと通信できない状態でホストが再起動した場合、ホストは予約したシートを使用し続けることができます。
- ホストがクラッシュしたときに接続されているホストに予約されているシートを解放し、ライセンスを使用している他のホストがすぐにシートを使用できるようにします。
- ライセンス監査データを保存するための安全な場所が提供されるため、ホストが再起動されてもデータが失われたり破損したりすることはありません。

GO-Globalホストは、その役割に関係なく、バックアップライセンスマネージャとして使用できます。ただし、上記の2番目の機能を提供するには、サービスを提供するホストと同じcloudライセンスを使用して、バックアップライセンスマネージャで GO-Globalを(アクティベーションウィザードを使用して)アクティベーションする必要があります。

ホストは複数のバックアップライセンスマネージャを使用するように設定できます。高可用性を実現するためには、少なくとも1つは必要です。バックアップライセンスマネージャを追加すると、高可用性のレベルが向上します。

### バックアップライセンスマネージャを設定する方法
1. バックアップライセンスマネージャとして機能するコンピュータで、アクティベーションウィザードを実行し、接続するホストが使用するcloudライセンスを選択します。
2. バックアップライセンスマネージャを使用する各GO-Globalホストで、Admin Consoleを実行し、 **[Tools | Host Options]** をクリックします。
3. **[Configuration]** タブをクリックします。
4. **[Backup License Manager(s)]** フィールドに、バックアップライセンスマネージャコンピュータのアドレスを入力します。オプションで、冗長性を確保するために、複数のバックアップライセンスマネージャのアドレスをセミコロンで区切って入力します。例えば、server1_address;server2_address;server3_address といった具合です。
5. [Host Options]ダイアログの[Security]タブで、ホストとは異なるポートを使用するようにバックアップライセンスマネージャが設定されている場合は、アドレスの後のポートをカンマで区切って指定します。たとえば、server1,443: server2,443;server3となります。
6. **[OK]** をクリックします。
7. **GO-Global Application Publishing Service** を再起動します。

GraphOnでは、フェイルオーバーアプリケーションホストマネージャ(フェイルオーバーRelay Load Balancersなど)をプライマリのアプリケーションホストマネージャのバックアップライセンスマネージャとして設定することをお勧めします。これにより、例えば、プライマリのRelay Load Balancersがクラッシュしたときに、プライマリのRelay Load Balancersが予約したシートをフェイルオーバーのRelay Load Balancersがすぐに利用できるようになります。

{{% alert title="参照" color="info" %}}
バックアップライセンスマネージャは、ホストがcloudライセンスを使用して構成されている場合にのみ使用できます。ホストがOn-premisesライセンスを使用して構成されている場合、この制御は無効になります。
{{% /alert %}}

# 緊急時のOn-premisesライセンス
お客様がcloudライセンスサービスへの接続を72時間以内に復旧できない場合、またはその他の理由でcloudライセンスを使用しているホストの問題を解決できない場合、お客様はカスタマーポータルでそのホストの緊急On-premisesライセンスを要求できます。cloudライセンスサービスへの接続が失われた場合、72時間以内に接続が復旧しないことが予想される場合を除き、お客様は緊急時のOn-premisesライセンスを要求しないでください。<br>

緊急のOn-premisesライセンスをリクエストするには、お客様はcloudライセンスのプロダクトコードを提供する必要があります。これは、cloudライセンスを使用しているお客様がライセンスのプロダクトコードを必要とする唯一の状況です。

## 緊急時のOn-premisesライセンスを取得する方法

1. ホストのcloudライセンスのプロダクトコードをクリップボードにコピーします。<br>
a. Admin Consoleを実行します。<br>
b. **[Licenses]** クリックします。<br>
c. **[Copy product code]** をクリックします。<br>
2. カスタマーポータルにサインインします。<br>
3. **[License Management]** をクリックします。<br>
4. **[Emergency License Request]** をクリックします。<br>
5. ステップ1でコピーしたプロダクトコードを **プロダクトコード** フィールドに貼り付けて、フォームに記入します。<br>
6. **[Request Emergency License]** をクリックします。<br>

これらの手順が完了すると、カスタマーポータルで入力された情報が検証され、フォームで指定された電子メールアドレスに一時的なOn-premisesライセンスファイルが送信されます。

## 緊急時のOn-premisesライセンスをインストールする方法

1. 緊急時のOn-premisesのライセンスファイルを受け取ったら、ホスト上の`\Program Files\GraphOn\GO-GlobalLicensing`ディレクトリにファイルをコピーしてください。
2. **GO-Global License Manager Service** を開始します。
3. **Application Publishing Service** を再起動します。

ホスト上のLicensingディレクトリにOn-premisesライセンスファイルがある場合、cloudライセンスを使用するように構成されているホストでは、cloudライセンスの代わりにOn-premisesライセンスが使用されます。cloudライセンスの使用に戻すには、ライセンスディレクトリからOn-premisesライセンスファイルを削除し、Application Publishing Serviceを再起動します。
