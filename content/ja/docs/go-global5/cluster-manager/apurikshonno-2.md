+++
title = "アプリケーションの管理"
description = ""
weight = 2
+++

GO-Globalでは、特定のアプリケーションをユーザに公開したり、ユーザがホストのデスクトップにアクセスすることを許可したりできます。

## アプリケーションのインストール

GO-Global を介して実行されるアプリケーションをインストールする場合、ベンダー提供の関連文書を参照して、適切なマルチユーザインストール方法を確認してください。ほとんどの場合、管理者アカウントでアプリケーションをインストールする必要がありますが、各アプリケーションによってインストール要件は異なります。またインストールは、マルチユーザ展開に関するMicrosoftのガイドラインに準拠する必要があります

>GO-Globalを介してアプリケーションを展開しても、各企業が無制限のアクセス権を取得することにはなりません。同時に実行できるアプリケーションの数に関しては、ベンダーのライセンス供与規定に準拠する必要があります。

## アプリケーションの公開

アプリケーションはCluster Managerを使って公開されます。 Cluster Managerを介してアプリケーションを公開するときに、アプリケーションの起動方法を制御する起動パラメータを指定できます。

## アプリケーションを公開する方法

1. [**All Hosts**]の一覧から、目的のサーバを選択します。
2. [**Applications**]タブをクリックします。
3. [**Add**]ボタンをクリックします。
4. [**Executable Path**]ボックスの横にある [**Browse**]ボタンをクリックして、アプリケーションの実行可能ファイルを検索します。
5. 上述の手順でアプリケーションの .exeファイルを参照すると、そのファイル名が自動的に [**Display Name**]ボックス内に入力されます (アプリケーション名は Program Window に表示されます)。そのままデフォルトの表示名を使用することも、新しい名称を入力することも可能です。アプリケーションの表示名をスペースのみにすることはできません。また、バックスラッシュ(\)も使用できません。このフィールドは空欄のままにしないでください。
6. アプリケーションの実行可能ファイルを参照すると、そのディレクトリのパス名が自動的に [**Start Directory**]ボックス内に表示されます。表示されない場合は、アプリケーションを起動するディレクトリのフルパス名を入力します。
7. [**Startup State**]セクションで、そのアプリケーションの起動モード([Maximized]、[Minimized]または [Normal])を選択します。
8. [**Command-Line Options**]ボックスでは、アプリケーション起動時のパラメータを指定できます。これらのパラメータは各アプリケーションに固有なので、起動時のパラメータ指定に関する情報は、各アプリケーションの関連文書を参照してください。
9. アプリケーションのデフォルトアイコン以外のアイコンを選択したい場合は、 [**Change Icon**]ボタンをクリックします。
10. [**OK**]をクリックし、作業を終了します。

![4-2-1](/image5/4-2-1.png)

Cluster Managerへのアプリケーションの登録が完了すると、 [**Installed Applications**]の一覧にそのアプリケーション名とパス名が表示されます。カラムのタイトルをクリックすると、一覧内の項目を昇順または降順で並べ替えできます。Cluster Manager内の一覧はすべて、この方法で並べ替えできます。ODBCデータソースを使用するアプリケーションを設定する場合は、GO-Globalクライアントがそのデータソースへアクセスできるよう、ODBCドライバをシステムDSNs(データソース名)として設定する必要があります。データソースに関する詳細情報は、Windows ODBC Data Source Administratorのオンラインヘルプを参照してください。

アクセス制限により、Cluster ManagerではUNCフォーマットで指定されたパス(例 : \Machine Name\Folder Name...)、またはマッピングされたネットワークドライブ上にあるパスの有効性を検証できません。公開された項目のExecutable PathまたはStart Directoryが、マッピングされたドライブを含むか、UNCパスで指定されている場合、Cluster Managerでは、それが有効であるか否かに関わらず、その指定パスを受け付けます。パスが無効な場合、またはクライアントユーザが指定された実行可能ファイルやフォルダへのアクセス権を持たない場合、公開された項目はProgram Windowに表示されません。その項目を選択して、 [**Properties**]ボタンをクリックします。そこで、その項目の[Executable Path]または [Start Directory]を更新します。その項目がアンインストールまたは新規の場所に移動されていると、Application Publishing Serviceが再開された後には、Cluster Manager内に表示されません。

Cluster Managerでは、UNCフォーマットで指定された、またはマッピングされたドライブにある任意の項目のパスに対するグループやユーザの設定は表示できません。これが当てはまる場合、任意のアプリケーションやファイルに対して、Cluster Managerの[Application Users/Groups]画面に「User/Group settings not available.(ユーザ/グループ設定は利用できません)」というメッセージが表示されます。

マッピングされたドライブ上に存在はしていてもGO-Globalでの利用ライセンスが供与されていない項目をCluster Manager内で公開すると、その項目のアイコンがProgram Windowに表示されます。しかし、ユーザはその項目をオープンすることはできず、起動するとエラーメッセージが表示されます。

>[Installed Applications]の一覧または[Application Users/Groups]の一覧内の項目上でマウスボタンを右クリックすると、最も頻繁に使用されるコマンドのショートカットメニューが表示されます。

## アプリケーションのプロパティの編集

Cluster Managerへのアプリケーションの追加が完了したら、そのアプリケーションのプロパティを常時編集できます。たとえば、アプリケーションのスタートアップ状態、実行可能ファイルの場所、アプリケーションを起動するフォルダの編集が可能です。

### アプリケーションのプロパティの編集方法

1. [**Applications**]タブをクリックします。
2. [**Installed Applications**]の一覧からアプリケーションを選択します。
3. [**Properties**]ボタンをクリックします。
4. 以下のいずれかの操作を行います。
a. [**Executable Path**]ボックス内に、新しいパス名を入力します。
b. [**Start Directory**]ボックス内に、アプリケーションを起動するディレクトリのフルパス名を入力します。
c. [**Command-Line Options**]ボックス内に、そのアプリケーション用のスタートアップパラメータを入力します。
d. [**Display Name**]ボックス内に、そのアプリケーションの新しい表示名を入力します。
e. [**Startup State**]セクションで、そのアプリケーションの起動モード(Maximized、Minimized、Normal)を選択します。
f. [**Change Icon**]ボタンをクリックして、新しいアプリケーションアイコンを検索します。 

## アプリケーションの複製

アプリケーションの複製では、選択された登録済みアプリケーションの完全なコピーが作成されます。これは、同一のアプリケーションを異なるユーザやグループに対してさまざまな形で利用可能にする場合に便利です。たとえば、[Sign In]ダイアログを表示しないコマンド行オプション付きの1つのバージョンのアプリケーションと、クライアントにサインインを要求するコマンド行オプションのない別のバージョンのアプリケーションを登録できます。アプリケーションを複製する場合には、新しい表示名を選択する必要があります。

### アプリケーションの複製方法

1. [**Installed Applications**]の一覧から複製するアプリケーションを選択します。
2. [Tools | Applications | Duplicate]の順にクリックします。

－または－

   [Installed Applications]の一覧の右側にある [**Duplicate**]ボタンをクリックします。

## アプリケーション名の変更

アプリケーションに割り当てる表示名は、エンドユーザのProgram Windowに表示されます。アプリケーションの表示名は常時変更可能です。

### アプリケーションの表示名の変更方法

1. [Installed Applications]の一覧から名前を変更するアプリケーションを選択します。
2. [Tools | Applications | Rename]の順にクリックします。

－または－

　　[Installed Applications]の一覧の右側にある[**Rename**]ボタンをクリックします。

## ユーザやグループに対するアプリケーション起動パラメータの割り当て

Cluster Managerでは、ネットワーク上またはローカルマシン上のユーザやグループに対するアプリケーションの実行方法を指定するパラメータの割り当てが可能です。ユーザやグループに対して設定されたパラメータは、ユーザやグループがそのアプリケーションを起動する度に適用されます。個人に対して設定されたアプリケーション起動パラメータは、グループやアプリケーションに対して設定されたパラメータより優先されます。クライアントがGO-Globalを介してアプリケーションを起動すると、Program Windowは、まず個別ユーザに対して割り当てられた起動パラメータを確認します。何もパラメータが割り当てられていない場合は、Program Windowがシステムから取得した順に、そのユーザが属するグループの一覧を確認します。または、Program Windowは、そのアプリケーションに割り当てられている一般的な起動パラメータを検索します。

> [**About GraphOn GO-Global**]ボックスで、ユーザが割り当てられているグループ、およびシステムにおけるそのグループ一覧の順序を確認できます。

ユーザやグループ用のファイルアクセス許可は、サーバのWindows NTファイル システム (NTFS) セキュリティ設定によって制御されます。ファイルアクセス許可は、Cluster Managerを通して設定することはできません。[Installed Applications]一覧からアプリケーションを選択すると、そのファイルやアプリケーション対してNTFSで指定されたユーザのアクセス許可が、[Application Users/Groups]一覧に表示されます。次に、特定のユーザやグループに対するアプリケーションのプロパティを編集できます。ファイルアクセス許可はNTFSで初期化されたドライブ上でのみ設定可能です。FATファイルシステムを使用している場合は、特定ファイルにアクセス許可を設定したり、アプリケーションへのアクセスを制限したりすることはできません。

### ユーザまたはグループに対するアプリケーション起動パラメータの割り当て方法

1. [**Applications**]タブをクリックします。
2. [**Installed Applications**]の一覧からアプリケーションを選択します。
3. [**Application Users/Groups**]の一覧からユーザまたはグループを選択します。
4. [**Properties**]ボタンをクリックします。
5. 以下のいずれかの操作を行います。
  a. [**Start Directory**]ボックス内に、アプリケーションを起動するディレクトリ内のフル パス名を入力します。
  b. [**Startup State**]セクションで、そのアプリケーションの起動モード (Maximized、Minimized、Normal) を選択します。
  c. [**Command-Line Options**]ボックス内に、そのアプリケーションの起動時に使用するコマンド行引数を入力します。

>ファイルシステムを使用している場合は、特定ファイルにアクセス許可を設定したり、アプリケーションへのアクセスを制限することはできません。

## アプリケーションの削除

GO-Globalで展開したアプリケーションは、Cluster Managerで削除します。Cluster Managerでアプリケーションを削除しても、サーバからは削除されません。GO-Globalクライアントがそのアプリケーションにアクセスできなくなるだけです。

### アプリケーションの削除方法

1. [**Applications**]タブをクリックします。
2. [Installed Applications]の一覧から削除するアプリケーションを選択します。
3. [**Remove**]ボタンをクリックします。

－または－

　　[Tools | Applications | Remove]の順にクリックします。

Cluster Managerでインストール済みアプリケーションを削除する時に、あるユーザがそのアプリケーションを実行していた場合、そのユーザのセッションは中断されません。しかし、そのユーザがそのアプリケーションを終了すると、そのアプリケーションは利用不可能になり、Program Window内にアイコンは表示されません。

## ホストのデスクトップへのアクセスを提供

>デスクトップ機能はWindows2012R2でのみの提供になります。

特定のアプリケーションをユーザに公開することに加えて、ユーザにホストのデスクトップへのアクセスを許可することができます(スタートメニュー、タスクバーなど)。

1. 以下のいずれかのディレクトリで **HostProperties.xml**ファイルを見つけます。 C:\Documents and Settings\All Users\Application Data\GraphOn(On Windows 2003); C:\ProgramData\GraphOn(On Windows 2008).
2. ワードパッドで **HostProperties.xml**を開きます。
3. **AllowDesktop**プロパティを見つけます。 **AllowDesktop**プロパティがファイルに存在しない場合(たとえば、HostがGO-Global 4からアップグレードされた場合)、 **AllowDesktop**プロパティをファイルに追加します。
  a. **AllowCreateSessionOnConnect**プロパティに関連付けられている行をコピーします。
  b. **AllowCreateSessionOnConnect**セクションの後の行の先頭にキャレットを置きます。
  c. コピーした行をファイルに貼り付けます。
  d. 貼り付けたテキストの **AllowCreateSessionOnConnect**を **AllowDesktop**に変更します。
4. **AllowDesktop**プロパティをtrueに設定します。
5. ファイルを保存してください。

**AllowDesktop**プロパティがtrueに設定されていると、ユーザはクライアントのコマンドラインに"-desktop"を追加することでGO-Globalクライアントからホストのデスクトップにアクセスできます。このオプションを指定すると、クライアントはリモートセッションとそのデスクトップをクライアントコンピュータのウィンドウ内に表示します。

デスクトップをユーザに公開するには、GO-GlobalのURLまたはリンクに「＆desktop=true」を追加します。ブラウザウィンドウ内にデスクトップを表示するには、URLに「＆embed=true」も含めます。埋め込みオプションが指定されていない場合、GO-Globalはブラウザの外側にウィンドウを作成し、そのウィンドウにリモートセッションとデスクトップを表示します。

Windowsデスクトップを実行しているセッションから切断するには、ユーザはクライアントウィンドウを閉じるか、セッションがブラウザ内に埋め込まれて実行されている場合はブラウザタブを閉じるか別のページに移動します。

Windowsデスクトップを実行しているセッションからログオフするには、Windowsデスクトップの[ログオフ]または[サインアウト]オプションをクリックします。
